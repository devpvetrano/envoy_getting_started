#!/bin/bash
curl -v --location --request GET 'localhost:8080/api/customer' \
--header 'Actor-Token: eyJhbGciOiJFUzI1NiIsImtpZCI6Indvcmtmb3JjZUlEUC1FUzI1NiJ9.ewogICAgImlzcyI6ICJ3b3JrZm9yY2VJZGVudGl0eS5leGFtcGxlLmNvbSIsCiAgICAic3ViIjogIndvcmtmb3JjZUlkZW50aXR5OjQwNjMxOSIsCiAgICAiYXVkIjogWyAiYXBpZ2F0ZXdheS5leGFtcGxlLmNvbSIsICJwcm90ZWN0ZWQtc3R1ZmYuZXhhbXBsZS5jb20iXSwKICAgICJhenAiOiAiYXBwXzEyMzQ1NiIsCiAgICAiZXhwIjogMjczNTY4OTYwMCwKICAgICJpYXQiOiAxNTk3Njc2NzE4LAogICAgImF1dGhfdGltZSI6IDE1OTc2NzY3MTgsCiAgICAianRpIjogIm1QUGR3SjdKcnIyTVF6UyIKfQ.RYXZtWlcERiN19RI7KVeZivGE0pc5l59zPf3Uew6TqyxZQYPnq8NGJVATjuHVVXckwY3VM430K-if77L8yHeRA' \
--header 'App-Token: eyJhbGciOiJSUzI1NiIsImtpZCI6IkFQSUdXLVJTMjU2In0.ewogICAgImlzcyI6ICJhcGlnYXRld2F5LmV4YW1wbGUuY29tIiwKICAgICJzdWIiOiAiYXBpZ2F0ZXdheTphcHBfMDAwMTIzIiwKICAgICJhdWQiOiBbICJhcGlnYXRld2F5LmV4YW1wbGUuY29tIiwgInByb3RlY3RlZC1zdHVmZi5leGFtcGxlLmNvbSJdLAogICAgImF6cCI6ICJhcHBfMDAwMTIzIiwKICAgICJjbGllbnRfaWQiOiAiYXBwXzAwMDEyMyIsCiAgICAiZXhwIjogMjczNTY4OTYwMCwKICAgICJpYXQiOiAxNTk3Njc2NzE4LAogICAgImF1dGhfdGltZSI6IDE1OTc2NzY3MTgsCiAgICAianRpIjogIlhjT3BRZTJ2cVRxNjYxayIsCiAgICAiZ3JhbnQiOiAiY2xpZW50X2NyZWRlbnRpYWxzIiwKICAgICJvd25pbmdMZWdhbEVudGl0eSI6ICJFeGFtcGxlIENvLiIsCiAgICAic2NvcGVzIjogWwogICAgICAicmV3YXJkczpyZWFkIiwKICAgICAgInJld2FyZHM6cmVkZWVtIgogICAgXSwKICAgICJraWQiOiAiQVBJR1ctRVMyNTYiCn0.mjU1vCnm19zMjLuEj0pE3Cbuq26K4ZWHxeUNccFsP3wEvTYMfDsu3NvXvxeK2S5vKeVh6EIqZEvhsYrJ0o5GZxY8L3NoXIYjbsrHvjenFrP7itgZpicf6PlSW7QaoQvJ4Ux9Fmv8PzjYGc1WS3nYhPOQXZH5jEGLDdtV-6QGh5-3K0Dzgt7XBg1CSo071wkBf-H7uu6a2BkwiPmjUE8JcGSwhwM3GMVfGca65ydJH9uqlCf91MvhUa5-ruJ1jA_mEE88_qfzqQ93zW7S5J68rY5jhOKfHMx7veYYGfXFTsRjvJ7wtSIZ1ECtuYhpOQW3i58j6Gp45mB1vSm0QqsX0A' \
--header 'Postman-Token: 30adea4d-1e24-44ab-a58d-e65d65052aae'


curl -v --location --request PUT 'localhost:8080/api/customer/12345/account/12345' \
--header 'Actor-Token: eyJhbGciOiJFUzI1NiIsImtpZCI6Indvcmtmb3JjZUlEUC1FUzI1NiJ9.ewogICAgImlzcyI6ICJ3b3JrZm9yY2VJZGVudGl0eS5leGFtcGxlLmNvbSIsCiAgICAic3ViIjogIndvcmtmb3JjZUlkZW50aXR5OjQwNjMxOSIsCiAgICAiYXVkIjogWyAiYXBpZ2F0ZXdheS5leGFtcGxlLmNvbSIsICJwcm90ZWN0ZWQtc3R1ZmYuZXhhbXBsZS5jb20iXSwKICAgICJhenAiOiAiYXBwXzEyMzQ1NiIsCiAgICAiZXhwIjogMjczNTY4OTYwMCwKICAgICJpYXQiOiAxNTk3Njc2NzE4LAogICAgImF1dGhfdGltZSI6IDE1OTc2NzY3MTgsCiAgICAianRpIjogIm1QUGR3SjdKcnIyTVF6UyIKfQ.RYXZtWlcERiN19RI7KVeZivGE0pc5l59zPf3Uew6TqyxZQYPnq8NGJVATjuHVVXckwY3VM430K-if77L8yHeRA' \
--header 'App-Token: eyJhbGciOiJSUzI1NiIsImtpZCI6IkFQSUdXLVJTMjU2In0.ewogICAgImlzcyI6ICJhcGlnYXRld2F5LmV4YW1wbGUuY29tIiwKICAgICJzdWIiOiAiYXBpZ2F0ZXdheTphcHBfMDAwMTIzIiwKICAgICJhdWQiOiBbICJhcGlnYXRld2F5LmV4YW1wbGUuY29tIiwgInByb3RlY3RlZC1zdHVmZi5leGFtcGxlLmNvbSJdLAogICAgImF6cCI6ICJhcHBfMDAwMTIzIiwKICAgICJjbGllbnRfaWQiOiAiYXBwXzAwMDEyMyIsCiAgICAiZXhwIjogMjczNTY4OTYwMCwKICAgICJpYXQiOiAxNTk3Njc2NzE4LAogICAgImF1dGhfdGltZSI6IDE1OTc2NzY3MTgsCiAgICAianRpIjogIlhjT3BRZTJ2cVRxNjYxayIsCiAgICAiZ3JhbnQiOiAiY2xpZW50X2NyZWRlbnRpYWxzIiwKICAgICJvd25pbmdMZWdhbEVudGl0eSI6ICJFeGFtcGxlIENvLiIsCiAgICAic2NvcGVzIjogWwogICAgICAicmV3YXJkczpyZWFkIiwKICAgICAgInJld2FyZHM6cmVkZWVtIgogICAgXSwKICAgICJraWQiOiAiQVBJR1ctRVMyNTYiCn0.mjU1vCnm19zMjLuEj0pE3Cbuq26K4ZWHxeUNccFsP3wEvTYMfDsu3NvXvxeK2S5vKeVh6EIqZEvhsYrJ0o5GZxY8L3NoXIYjbsrHvjenFrP7itgZpicf6PlSW7QaoQvJ4Ux9Fmv8PzjYGc1WS3nYhPOQXZH5jEGLDdtV-6QGh5-3K0Dzgt7XBg1CSo071wkBf-H7uu6a2BkwiPmjUE8JcGSwhwM3GMVfGca65ydJH9uqlCf91MvhUa5-ruJ1jA_mEE88_qfzqQ93zW7S5J68rY5jhOKfHMx7veYYGfXFTsRjvJ7wtSIZ1ECtuYhpOQW3i58j6Gp45mB1vSm0QqsX0A' \
--header 'Postman-Token: 48d83665-8c5f-4539-8ac1-4445bbfa019c'


curl -v --location --request DELETE 'localhost:8080/api/customer/12345/account/12345' \
--header 'Actor-Token: eyJhbGciOiJFUzI1NiIsImtpZCI6Indvcmtmb3JjZUlEUC1FUzI1NiJ9.ewogICAgImlzcyI6ICJ3b3JrZm9yY2VJZGVudGl0eS5leGFtcGxlLmNvbSIsCiAgICAic3ViIjogIndvcmtmb3JjZUlkZW50aXR5OjQwNjMxOSIsCiAgICAiYXVkIjogWyAiYXBpZ2F0ZXdheS5leGFtcGxlLmNvbSIsICJwcm90ZWN0ZWQtc3R1ZmYuZXhhbXBsZS5jb20iXSwKICAgICJhenAiOiAiYXBwXzEyMzQ1NiIsCiAgICAiZXhwIjogMjczNTY4OTYwMCwKICAgICJpYXQiOiAxNTk3Njc2NzE4LAogICAgImF1dGhfdGltZSI6IDE1OTc2NzY3MTgsCiAgICAianRpIjogIm1QUGR3SjdKcnIyTVF6UyIKfQ.RYXZtWlcERiN19RI7KVeZivGE0pc5l59zPf3Uew6TqyxZQYPnq8NGJVATjuHVVXckwY3VM430K-if77L8yHeRA' \
--header 'App-Token: eyJhbGciOiJSUzI1NiIsImtpZCI6IkFQSUdXLVJTMjU2In0.ewogICAgImlzcyI6ICJhcGlnYXRld2F5LmV4YW1wbGUuY29tIiwKICAgICJzdWIiOiAiYXBpZ2F0ZXdheTphcHBfMDAwMTIzIiwKICAgICJhdWQiOiBbICJhcGlnYXRld2F5LmV4YW1wbGUuY29tIiwgInByb3RlY3RlZC1zdHVmZi5leGFtcGxlLmNvbSJdLAogICAgImF6cCI6ICJhcHBfMDAwMTIzIiwKICAgICJjbGllbnRfaWQiOiAiYXBwXzAwMDEyMyIsCiAgICAiZXhwIjogMjczNTY4OTYwMCwKICAgICJpYXQiOiAxNTk3Njc2NzE4LAogICAgImF1dGhfdGltZSI6IDE1OTc2NzY3MTgsCiAgICAianRpIjogIlhjT3BRZTJ2cVRxNjYxayIsCiAgICAiZ3JhbnQiOiAiY2xpZW50X2NyZWRlbnRpYWxzIiwKICAgICJvd25pbmdMZWdhbEVudGl0eSI6ICJFeGFtcGxlIENvLiIsCiAgICAic2NvcGVzIjogWwogICAgICAicmV3YXJkczpyZWFkIiwKICAgICAgInJld2FyZHM6cmVkZWVtIgogICAgXSwKICAgICJraWQiOiAiQVBJR1ctRVMyNTYiCn0.mjU1vCnm19zMjLuEj0pE3Cbuq26K4ZWHxeUNccFsP3wEvTYMfDsu3NvXvxeK2S5vKeVh6EIqZEvhsYrJ0o5GZxY8L3NoXIYjbsrHvjenFrP7itgZpicf6PlSW7QaoQvJ4Ux9Fmv8PzjYGc1WS3nYhPOQXZH5jEGLDdtV-6QGh5-3K0Dzgt7XBg1CSo071wkBf-H7uu6a2BkwiPmjUE8JcGSwhwM3GMVfGca65ydJH9uqlCf91MvhUa5-ruJ1jA_mEE88_qfzqQ93zW7S5J68rY5jhOKfHMx7veYYGfXFTsRjvJ7wtSIZ1ECtuYhpOQW3i58j6Gp45mB1vSm0QqsX0A' \
--header 'Postman-Token: 8b7ca553-f8c6-4c18-bca9-98c997449f90'

docker logs 07_opa_validate_method_uri_opa_1  2> logs/stdErr_opa.jsonl
cat logs/stdErr_opa.jsonl | jq -cs '.' > logs/stdErr_opa.json

docker logs 07_opa_validate_method_uri_envoy_1 2> logs/stdErr_envoy.txt 

docker logs 07_opa_validate_method_uri_app_1 > logs/stdOut_hoverfly.jsonl
cat logs/stdOut_hoverfly.jsonl | jq -cs '.' > logs/stdOut_hoverfly.json
